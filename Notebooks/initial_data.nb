(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[         0,          0]
NotebookDataLength[     78827,       1948]
NotebookOptionsPosition[     73241,       1847]
NotebookOutlinePosition[     73934,       1870]
CellTagsIndexPosition[     73891,       1867]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Exact gaussian", "Title",
 CellChangeTimes->{{3.863136976542345*^9, 
  3.86313698399121*^9}},ExpressionUUID->"f0b4a695-9791-42ab-84b3-\
b31a804a95d8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "baseGaussian", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"baseGaussian", "[", 
     RowBox[{"r_", ",", "sigma_"}], "]"}], ":=", 
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"r", "^", "2"}]}], "/", 
      RowBox[{"(", 
       RowBox[{"2", 
        RowBox[{"sigma", "^", "2"}]}], ")"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "gaussianSolution", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gaussianSolution", "[", 
    RowBox[{"t_", ",", "r_", ",", "sigma_"}], "]"}], ":=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"baseGaussian", "[", 
        RowBox[{
         RowBox[{"r", "-", "t"}], ",", "sigma"}], "]"}], "-", 
       RowBox[{"baseGaussian", "[", 
        RowBox[{
         RowBox[{"r", "+", "t"}], ",", "sigma"}], "]"}]}], ")"}], "/", "r"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8648252134262943`*^9, 
  3.8648252144643*^9}},ExpressionUUID->"fc1751de-e353-4420-92be-718e709e4523"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\[CapitalPhi]", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalPhi]", "=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{"gaussianSolution", "[", 
      RowBox[{"t", ",", 
       RowBox[{"r", "[", 
        RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", "sigma"}], "]"}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"\[CapitalPsi]x", ",", "\[CapitalPsi]y", ",", "\[CapitalPsi]z"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalPsi]x", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"D", "[", 
     RowBox[{"\[CapitalPhi]", ",", "x"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalPsi]y", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"D", "[", 
     RowBox[{"\[CapitalPhi]", ",", "y"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalPsi]z", "=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{"D", "[", 
      RowBox[{"\[CapitalPhi]", ",", "z"}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "\[CapitalPi]", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalPi]", "=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{"(", 
      RowBox[{"alp", 
       SqrtBox["detgamma"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["alp", 
            RowBox[{"-", "2"}]]}], 
          RowBox[{"D", "[", 
           RowBox[{"\[CapitalPhi]", ",", "t"}], "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["alp", 
           RowBox[{"-", "2"}]], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"betax", "*", "\[CapitalPsi]x"}], "+", 
            RowBox[{"betay", "*", "\[CapitalPsi]y"}], "+", 
            RowBox[{"betaz", "*", "\[CapitalPsi]z"}]}], ")"}]}]}], ")"}]}], 
      ")"}], "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "rules", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rules", "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<alp\>\"", "\[Rule]", "\"\<alp[ijk]\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<betax\>\"", "\[Rule]", "\"\<betax[ijk]\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<betay\>\"", "\[Rule]", "\"\<betay[ijk]\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<betaz\>\"", "\[Rule]", "\"\<betaz[ijk]\>\""}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
      "\"\<Derivative(1,0,0)(gaussianSolution)(t,r(x,y,z),sigma)\>\"", 
       "\[Rule]", "\"\<d_exact_gaussian_solution_dt(t,r[ijk],sigma)\>\""}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
      "\"\<Derivative(0,1,0)(gaussianSolution)(t,r(x,y,z),sigma)\>\"", 
       "\[Rule]", "\"\<d_exact_gaussian_solution_dr(t,r[ijk],sigma)\>\""}], 
      ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
      "\"\<Derivative(1,0,0)(r)(x,y,z)\>\"", "\[Rule]", 
       "\"\<x[ijk]/r[ijk]\>\""}], ",", "\[IndentingNewLine]", 
      RowBox[{
      "\"\<Derivative(0,1,0)(r)(x,y,z)\>\"", "\[Rule]", 
       "\"\<y[ijk]/r[ijk]\>\""}], ",", "\[IndentingNewLine]", 
      RowBox[{
      "\"\<Derivative(0,0,1)(r)(x,y,z)\>\"", "\[Rule]", 
       "\"\<z[ijk]/r[ijk]\>\""}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<r(x,y,z)\>\"", "\[Rule]", "\"\<r[ijk]\>\""}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"\"\<Sqrt\>\"", "\[Rule]", "\"\<sqrt\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
      "\"\<gaussianSolution\>\"", "\[Rule]", 
       "\"\<exact_gaussian_solution\>\""}]}], "\[IndentingNewLine]", "}"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Pi[ijk] = \>\"", ",", 
    RowBox[{"StringReplace", "[", 
     RowBox[{
      RowBox[{"ToString", "[", 
       RowBox[{"\[CapitalPi]", ",", "CForm"}], "]"}], ",", "rules"}], "]"}], 
    ",", "\"\<;\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Psi_x[ijk] = \>\"", ",", 
    RowBox[{"StringReplace", "[", 
     RowBox[{
      RowBox[{"ToString", "[", 
       RowBox[{"\[CapitalPsi]x", ",", "CForm"}], "]"}], ",", "rules"}], "]"}],
     ",", "\"\<;\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Psi_y[ijk] = \>\"", ",", 
    RowBox[{"StringReplace", "[", 
     RowBox[{
      RowBox[{"ToString", "[", 
       RowBox[{"\[CapitalPsi]y", ",", "CForm"}], "]"}], ",", "rules"}], "]"}],
     ",", "\"\<;\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Psi_z[ijk] = \>\"", ",", 
    RowBox[{"StringReplace", "[", 
     RowBox[{
      RowBox[{"ToString", "[", 
       RowBox[{"\[CapitalPsi]z", ",", "CForm"}], "]"}], ",", "rules"}], "]"}],
     ",", "\"\<;\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Phi[ijk] = \>\"", ",", 
    RowBox[{"StringReplace", "[", 
     RowBox[{
      RowBox[{"ToString", "[", 
       RowBox[{"\[CapitalPhi]", ",", "CForm"}], "]"}], ",", "rules"}], "]"}], 
    ",", "\"\<;\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.863136989332446*^9, 3.863137019741555*^9}, {
   3.8631370522406673`*^9, 3.863137141468696*^9}, {3.863137197857668*^9, 
   3.86313722506809*^9}, {3.8631373301283293`*^9, 3.863137394364031*^9}, {
   3.863137504414342*^9, 3.863137594691284*^9}, {3.863137630512807*^9, 
   3.863137687919059*^9}, 3.8631377205899973`*^9, {3.8631810452353086`*^9, 
   3.863181098377767*^9}, {3.863181128948703*^9, 3.863181130678945*^9}, {
   3.86318131196056*^9, 3.863181329750854*^9}, {3.863181460047305*^9, 
   3.8631815041933413`*^9}, {3.863181537833399*^9, 3.863181643279627*^9}, {
   3.863181695730582*^9, 3.8631816979085093`*^9}, {3.863182246450102*^9, 
   3.863182281417409*^9}, {3.863182707180068*^9, 3.863182739560577*^9}, {
   3.863182799604052*^9, 3.863182977874655*^9}, {3.8631831174701023`*^9, 
   3.86318314572793*^9}, {3.863183175801857*^9, 3.863183196737749*^9}, {
   3.863183465677105*^9, 3.8631835838184433`*^9}, {3.86318396885089*^9, 
   3.863183983538224*^9}, 3.864823012179515*^9, {3.864825212556292*^9, 
   3.864825220432575*^9}, {3.864825310532633*^9, 3.864825366321402*^9}, {
   3.864825419945094*^9, 3.864825535240158*^9}, {3.864825834812289*^9, 
   3.864825835349976*^9}, {3.86482594847993*^9, 3.86482596096721*^9}},
 CellLabel->
  "In[214]:=",ExpressionUUID->"5428011b-1558-407c-a8b9-2760a421d5c0"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Pi[ijk] = \"\>", 
   "\[InvisibleSpace]", \
"\<\"(sqrt(detgamma)*(-d_exact_gaussian_solution_dt(t,r[ijk],sigma) + \
d_exact_gaussian_solution_dr(t,r[ijk],sigma)*(betaz[ijk]*z[ijk]/r[ijk] + \
betay[ijk]*y[ijk]/r[ijk] + betax[ijk]*x[ijk]/r[ijk])))/alp[ijk]\"\>", 
   "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm[
  "Pi[ijk] = ", 
   "(sqrt(detgamma)*(-d_exact_gaussian_solution_dt(t,r[ijk],sigma) + \
d_exact_gaussian_solution_dr(t,r[ijk],sigma)*(betaz[ijk]*z[ijk]/r[ijk] + \
betay[ijk]*y[ijk]/r[ijk] + betax[ijk]*x[ijk]/r[ijk])))/alp[ijk]", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{{3.864825466712772*^9, 3.864825535920327*^9}, 
   3.864825843157917*^9, 3.8648259627872763`*^9},
 CellLabel->
  "During evaluation of \
In[214]:=",ExpressionUUID->"8b5e43b1-264a-445d-b9ae-2163a3f080bf"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Psi_x[ijk] = \"\>", 
   "\[InvisibleSpace]", \
"\<\"d_exact_gaussian_solution_dr(t,r[ijk],sigma)*x[ijk]/r[ijk]\"\>", 
   "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm[
  "Psi_x[ijk] = ", 
   "d_exact_gaussian_solution_dr(t,r[ijk],sigma)*x[ijk]/r[ijk]", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{{3.864825466712772*^9, 3.864825535920327*^9}, 
   3.864825843157917*^9, 3.864825962788879*^9},
 CellLabel->
  "During evaluation of \
In[214]:=",ExpressionUUID->"f9ae0ed5-3b7f-4277-82eb-d828b2ab6171"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Psi_y[ijk] = \"\>", 
   "\[InvisibleSpace]", \
"\<\"d_exact_gaussian_solution_dr(t,r[ijk],sigma)*y[ijk]/r[ijk]\"\>", 
   "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm[
  "Psi_y[ijk] = ", 
   "d_exact_gaussian_solution_dr(t,r[ijk],sigma)*y[ijk]/r[ijk]", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{{3.864825466712772*^9, 3.864825535920327*^9}, 
   3.864825843157917*^9, 3.864825962790092*^9},
 CellLabel->
  "During evaluation of \
In[214]:=",ExpressionUUID->"335b6087-4a11-49e5-9c4c-41293a9b15ab"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Psi_z[ijk] = \"\>", 
   "\[InvisibleSpace]", \
"\<\"z[ijk]/r[ijk]*d_exact_gaussian_solution_dr(t,r[ijk],sigma)\"\>", 
   "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm[
  "Psi_z[ijk] = ", 
   "z[ijk]/r[ijk]*d_exact_gaussian_solution_dr(t,r[ijk],sigma)", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{{3.864825466712772*^9, 3.864825535920327*^9}, 
   3.864825843157917*^9, 3.8648259627908583`*^9},
 CellLabel->
  "During evaluation of \
In[214]:=",ExpressionUUID->"8d2d328d-695e-49ac-9378-0043f4fe4b6c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Phi[ijk] = \"\>", 
   "\[InvisibleSpace]", "\<\"exact_gaussian_solution(t,r[ijk],sigma)\"\>", 
   "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm["Phi[ijk] = ", "exact_gaussian_solution(t,r[ijk],sigma)", ";"],
  
  Editable->False]], "Print",
 CellChangeTimes->{{3.864825466712772*^9, 3.864825535920327*^9}, 
   3.864825843157917*^9, 3.864825962791707*^9},
 CellLabel->
  "During evaluation of \
In[214]:=",ExpressionUUID->"1d25621a-1091-41ee-bcfe-0a563ba4a1a8"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Plane wave", "Title",
 CellChangeTimes->{{3.863136976542345*^9, 3.86313698399121*^9}, {
  3.864224735609383*^9, 
  3.8642247372894087`*^9}},ExpressionUUID->"4f9e3ae7-b75c-446f-bec8-\
6846e2eedc4c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"omega", ",", "nx", ",", "ny", ",", "nz", ",", "nt", ",", "w"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"omega", "[", "wavenumber_", "]"}], ":=", 
   RowBox[{"Sqrt", "[", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"wavenumber", "[", "i", "]"}], "^", "2"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nx", "[", 
    RowBox[{"wavenumber_", ",", "spaceoffset_", ",", "x_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"wavenumber", "[", "1", "]"}], "*", 
    RowBox[{"(", 
     RowBox[{"x", "-", 
      RowBox[{"spaceoffset", "[", "1", "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ny", "[", 
    RowBox[{"wavenumber_", ",", "spaceoffset_", ",", "y_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"wavenumber", "[", "2", "]"}], "*", 
    RowBox[{"(", 
     RowBox[{"y", "-", 
      RowBox[{"spaceoffset", "[", "2", "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nz", "[", 
    RowBox[{"wavenumber_", ",", "spaceoffset_", ",", "z_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"wavenumber", "[", "3", "]"}], "*", 
    RowBox[{"(", 
     RowBox[{"z", "-", 
      RowBox[{"spaceoffset", "[", "3", "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nt", "[", 
    RowBox[{"wavenumber_", ",", "timeoffset_", ",", "t_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"omega", "[", "wavenumber", "]"}], "*", 
    RowBox[{"(", 
     RowBox[{"t", "-", "timeoffset"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"w", "[", 
     RowBox[{
     "wavenumber_", ",", "spaceoffset_", ",", "timeoffset_", ",", "t_", ",", 
      "x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
    RowBox[{"2", "\[Pi]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"nx", "[", 
        RowBox[{"wavenumber", ",", "spaceoffset", ",", "x"}], "]"}], "+", 
       RowBox[{"ny", "[", 
        RowBox[{"wavenumber", ",", "spaceoffset", ",", "y"}], "]"}], "+", 
       RowBox[{"nz", "[", 
        RowBox[{"wavenumber", ",", "spaceoffset", ",", "z"}], "]"}], "+", 
       RowBox[{"nt", "[", 
        RowBox[{"wavenumber", ",", "timeoffset", ",", "t"}], "]"}]}], 
      ")"}]}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "Phi", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Phi", "=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{"Cos", "[", 
      RowBox[{"w", "[", 
       RowBox[{
       "wavenumber", ",", "spaceoffset", ",", "timeoffset", ",", "t", ",", 
        "x", ",", "y", ",", "z"}], "]"}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"PsiX", ",", "PsiY", ",", "PsiZ", ",", "PPi"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Parallelize", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PsiX", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"D", "[", 
       RowBox[{"Phi", ",", "x"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    
    RowBox[{"PsiY", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"D", "[", 
       RowBox[{"Phi", ",", "y"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    
    RowBox[{"PsiZ", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"D", "[", 
       RowBox[{"Phi", ",", "z"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    
    RowBox[{"PPi", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Sqrt", "[", "detgamma", "]"}], "/", "alp"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"betax", "*", "PsiX"}], "+", 
           RowBox[{"betay", "*", "PsiY"}], "+", 
           RowBox[{"betaz", "*", "PsiZ"}]}], ")"}], "-", 
         RowBox[{"D", "[", 
          RowBox[{"Phi", ",", "t"}], "]"}]}], ")"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "rules", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rules", "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<alp\>\"", "\[Rule]", "\"\<alp[ijk]\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<betax\>\"", "\[Rule]", "\"\<betax[ijk]\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<betay\>\"", "\[Rule]", "\"\<betay[ijk]\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<betaz\>\"", "\[Rule]", "\"\<betaz[ijk]\>\""}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"\"\<wavenumber(1)\>\"", "\[Rule]", "\"\<wave_number[0]\>\""}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<wavenumber(2)\>\"", "\[Rule]", "\"\<wave_number[1]\>\""}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<wavenumber(3)\>\"", "\[Rule]", "\"\<wave_number[2]\>\""}], 
      ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
      "\"\<spaceoffset(1)\>\"", "\[Rule]", "\"\<space_offset[0]\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
      "\"\<spaceoffset(2)\>\"", "\[Rule]", "\"\<space_offset[1]\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
      "\"\<spaceoffset(3)\>\"", "\[Rule]", "\"\<space_offset[2]\>\""}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"\"\<timeoffset\>\"", "\[Rule]", "\"\<time_offset\>\""}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"\"\<fieldmass\>\"", "\[Rule]", "\"\<field_mass\>\""}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"\"\<x\>\"", "\[Rule]", "\"\<x[ijk]\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<y\>\"", "\[Rule]", "\"\<y[ijk]\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<z\>\"", "\[Rule]", "\"\<z[ijk]\>\""}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"\"\<Sqrt\>\"", "\[Rule]", "\"\<sqrt\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<Power\>\"", "\[Rule]", "\"\<pow\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<Sin\>\"", "\[Rule]", "\"\<sin\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<Cos\>\"", "\[Rule]", "\"\<cos\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<Pi\>\"", "\[Rule]", "\"\<M_PI\>\""}]}], 
     "\[IndentingNewLine]", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Pi[ijk] = \>\"", ",", 
    RowBox[{"StringReplace", "[", 
     RowBox[{
      RowBox[{"ToString", "[", 
       RowBox[{"PPi", ",", "CForm"}], "]"}], ",", "rules"}], "]"}], ",", 
    "\"\<;\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Psi_x[ijk] = \>\"", ",", 
    RowBox[{"StringReplace", "[", 
     RowBox[{
      RowBox[{"ToString", "[", 
       RowBox[{"PsiX", ",", "CForm"}], "]"}], ",", "rules"}], "]"}], ",", 
    "\"\<;\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Psi_y[ijk] = \>\"", ",", 
    RowBox[{"StringReplace", "[", 
     RowBox[{
      RowBox[{"ToString", "[", 
       RowBox[{"PsiY", ",", "CForm"}], "]"}], ",", "rules"}], "]"}], ",", 
    "\"\<;\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Psi_z[ijk] = \>\"", ",", 
    RowBox[{"StringReplace", "[", 
     RowBox[{
      RowBox[{"ToString", "[", 
       RowBox[{"PsiZ", ",", "CForm"}], "]"}], ",", "rules"}], "]"}], ",", 
    "\"\<;\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Phi[ijk] = \>\"", ",", 
    RowBox[{"StringReplace", "[", 
     RowBox[{
      RowBox[{"ToString", "[", 
       RowBox[{"Phi", ",", "CForm"}], "]"}], ",", "rules"}], "]"}], ",", 
    "\"\<;\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.863136989332446*^9, 3.863137019741555*^9}, {
   3.8631370522406673`*^9, 3.863137141468696*^9}, {3.863137197857668*^9, 
   3.86313722506809*^9}, {3.8631373301283293`*^9, 3.863137394364031*^9}, {
   3.863137504414342*^9, 3.863137594691284*^9}, {3.863137630512807*^9, 
   3.863137687919059*^9}, 3.8631377205899973`*^9, {3.8631810452353086`*^9, 
   3.863181098377767*^9}, {3.863181128948703*^9, 3.863181130678945*^9}, {
   3.86318131196056*^9, 3.863181329750854*^9}, {3.863181460047305*^9, 
   3.8631815041933413`*^9}, {3.863181537833399*^9, 3.863181643279627*^9}, {
   3.863181695730582*^9, 3.8631816979085093`*^9}, {3.863182246450102*^9, 
   3.863182281417409*^9}, {3.863182707180068*^9, 3.863182739560577*^9}, {
   3.863182799604052*^9, 3.863182977874655*^9}, {3.8631831174701023`*^9, 
   3.86318314572793*^9}, {3.863183175801857*^9, 3.863183196737749*^9}, {
   3.863183465677105*^9, 3.8631835838184433`*^9}, {3.86318396885089*^9, 
   3.863183983538224*^9}, 3.864224828032547*^9, 3.864224859991782*^9, {
   3.864224899143249*^9, 3.864224920999689*^9}, {3.864225054136395*^9, 
   3.864225092924685*^9}, {3.864225126367833*^9, 3.8642251310251703`*^9}, {
   3.864225187169249*^9, 3.864225272431669*^9}, {3.864225409370202*^9, 
   3.86422541672962*^9}, {3.8642256181654463`*^9, 3.864225729383523*^9}, {
   3.864225812622473*^9, 3.8642258274719276`*^9}, {3.864226038727384*^9, 
   3.86422605790557*^9}, {3.864226132424708*^9, 3.864226139433097*^9}, {
   3.8642275685977592`*^9, 3.864227569627873*^9}, {3.864259599907468*^9, 
   3.864259616160166*^9}, {3.864260340060958*^9, 3.864260351219144*^9}, {
   3.8644953500952168`*^9, 3.864495398221027*^9}, {3.864509213770502*^9, 
   3.8645093054045553`*^9}, {3.8645107754741173`*^9, 
   3.8645108248087177`*^9}, {3.8645108734395647`*^9, 3.86451088202094*^9}, {
   3.864510928328616*^9, 3.864510930206352*^9}, {3.8645110917437696`*^9, 
   3.864511095772285*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"dcf2497d-8e8a-43e1-906f-782b7d73ee27"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Pi[ijk] = \"\>", 
   "\[InvisibleSpace]", "\<\"(2*sqrt(detgamma)*M_PI*sin(2*M_PI*((x[ijk] - \
space_offset[0])*wave_number[0] + (y[ijk] - space_offset[1])*wave_number[1] + \
(z[ijk] - space_offset[2])*wave_number[2] + (t - \
time_offset)*sqrt(pow(wave_number[0],2) + pow(wave_number[1],2) + \
pow(wave_number[2],2))))*(-(betax[ijk]*wave_number[0]) - \
betay[ijk]*wave_number[1] - betaz[ijk]*wave_number[2] + \
sqrt(pow(wave_number[0],2) + pow(wave_number[1],2) + \
pow(wave_number[2],2))))/alp[ijk]\"\>", "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm[
  "Pi[ijk] = ", 
   "(2*sqrt(detgamma)*M_PI*sin(2*M_PI*((x[ijk] - \
space_offset[0])*wave_number[0] + (y[ijk] - space_offset[1])*wave_number[1] + \
(z[ijk] - space_offset[2])*wave_number[2] + (t - \
time_offset)*sqrt(pow(wave_number[0],2) + pow(wave_number[1],2) + \
pow(wave_number[2],2))))*(-(betax[ijk]*wave_number[0]) - \
betay[ijk]*wave_number[1] - betaz[ijk]*wave_number[2] + \
sqrt(pow(wave_number[0],2) + pow(wave_number[1],2) + \
pow(wave_number[2],2))))/alp[ijk]", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8645111135675163`*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"b75851e4-9263-4728-8d16-341ec52f968f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Psi_x[ijk] = \"\>", 
   "\[InvisibleSpace]", "\<\"-2*M_PI*sin(2*M_PI*((x[ijk] - \
space_offset[0])*wave_number[0] + (y[ijk] - space_offset[1])*wave_number[1] + \
(z[ijk] - space_offset[2])*wave_number[2] + (t - \
time_offset)*sqrt(pow(wave_number[0],2) + pow(wave_number[1],2) + \
pow(wave_number[2],2))))*wave_number[0]\"\>", 
   "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm[
  "Psi_x[ijk] = ", 
   "-2*M_PI*sin(2*M_PI*((x[ijk] - space_offset[0])*wave_number[0] + (y[ijk] - \
space_offset[1])*wave_number[1] + (z[ijk] - space_offset[2])*wave_number[2] + \
(t - time_offset)*sqrt(pow(wave_number[0],2) + pow(wave_number[1],2) + \
pow(wave_number[2],2))))*wave_number[0]", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8645111135720577`*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"806d6857-bacc-4c46-b883-2a57bd887910"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Psi_y[ijk] = \"\>", 
   "\[InvisibleSpace]", "\<\"-2*M_PI*sin(2*M_PI*((x[ijk] - \
space_offset[0])*wave_number[0] + (y[ijk] - space_offset[1])*wave_number[1] + \
(z[ijk] - space_offset[2])*wave_number[2] + (t - \
time_offset)*sqrt(pow(wave_number[0],2) + pow(wave_number[1],2) + \
pow(wave_number[2],2))))*wave_number[1]\"\>", 
   "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm[
  "Psi_y[ijk] = ", 
   "-2*M_PI*sin(2*M_PI*((x[ijk] - space_offset[0])*wave_number[0] + (y[ijk] - \
space_offset[1])*wave_number[1] + (z[ijk] - space_offset[2])*wave_number[2] + \
(t - time_offset)*sqrt(pow(wave_number[0],2) + pow(wave_number[1],2) + \
pow(wave_number[2],2))))*wave_number[1]", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{3.864511113574744*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"89057223-7799-4cae-b87e-07e81d223821"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Psi_z[ijk] = \"\>", 
   "\[InvisibleSpace]", "\<\"-2*M_PI*sin(2*M_PI*((x[ijk] - \
space_offset[0])*wave_number[0] + (y[ijk] - space_offset[1])*wave_number[1] + \
(z[ijk] - space_offset[2])*wave_number[2] + (t - \
time_offset)*sqrt(pow(wave_number[0],2) + pow(wave_number[1],2) + \
pow(wave_number[2],2))))*wave_number[2]\"\>", 
   "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm[
  "Psi_z[ijk] = ", 
   "-2*M_PI*sin(2*M_PI*((x[ijk] - space_offset[0])*wave_number[0] + (y[ijk] - \
space_offset[1])*wave_number[1] + (z[ijk] - space_offset[2])*wave_number[2] + \
(t - time_offset)*sqrt(pow(wave_number[0],2) + pow(wave_number[1],2) + \
pow(wave_number[2],2))))*wave_number[2]", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{3.864511113576653*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"f2fe2acd-fe9e-41a5-a0cb-2c07b0a92f77"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Phi[ijk] = \"\>", 
   "\[InvisibleSpace]", "\<\"cos(2*M_PI*((x[ijk] - \
space_offset[0])*wave_number[0] + (y[ijk] - space_offset[1])*wave_number[1] + \
(z[ijk] - space_offset[2])*wave_number[2] + (t - \
time_offset)*sqrt(pow(wave_number[0],2) + pow(wave_number[1],2) + \
pow(wave_number[2],2))))\"\>", "\[InvisibleSpace]", "\<\";\"\>"}],
  SequenceForm[
  "Phi[ijk] = ", 
   "cos(2*M_PI*((x[ijk] - space_offset[0])*wave_number[0] + (y[ijk] - \
space_offset[1])*wave_number[1] + (z[ijk] - space_offset[2])*wave_number[2] + \
(t - time_offset)*sqrt(pow(wave_number[0],2) + pow(wave_number[1],2) + \
pow(wave_number[2],2))))", ";"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8645111135783243`*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"7a95ac2d-d747-4ede-859e-0007b2e9bdbd"]
}, Open  ]]
}, Open  ]],

Cell["\<\
To compute the exact RHS results, we assume a minkowski background\
\>", "Text",
 CellChangeTimes->{{3.864259730737692*^9, 
  3.864259749897616*^9}},ExpressionUUID->"3be7ae37-78c0-4ed5-96ad-\
e62616898bd3"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"alp", ",", "betax", ",", "betay", ",", "betaz", ",", "detgamma"}],
    "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"alp", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"betax", "=", 
   RowBox[{"betay", "=", 
    RowBox[{"betaz", "=", "0"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"detgamma", "=", "1"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"Fx", ",", "Fy", ",", "Fz"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Fx", "=", "PsiX"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Fy", "=", "PsiY"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Fz", "=", "PsiZ"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{"\"\<Pi_multipatch_error[ijk] = abs(Pi_rhs[ijk] - (\>\"", ",", 
     RowBox[{"StringReplace", "[", 
      RowBox[{
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"Simplify", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"fieldmass", "^", "2"}], "*", "Phi"}], "-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{"Fx", ",", "x"}], "]"}], "+", 
             RowBox[{"D", "[", 
              RowBox[{"Fy", ",", "y"}], "]"}], "+", 
             RowBox[{"D", "[", 
              RowBox[{"Fz", ",", "z"}], "]"}]}], ")"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "CForm"}], "]"}], ",", "rules"}],
       "]"}], ",", "\"\<));\>\""}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{
   "\"\<Psi_x_multipatch_error[ijk] = abs(Psi_x_rhs[ijk] - (\>\"", ",", 
    RowBox[{"StringReplace", "[", 
     RowBox[{
      RowBox[{"ToString", "[", 
       RowBox[{
        RowBox[{"Simplify", "[", 
         RowBox[{"D", "[", 
          RowBox[{"PPi", ",", "x"}], "]"}], "]"}], ",", "CForm"}], "]"}], ",",
       "rules"}], "]"}], ",", "\"\<));\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{
   "\"\<Psi_y_multipatch_error[ijk] = abs(Psi_y_rhs[ijk] - (\>\"", ",", 
    RowBox[{"StringReplace", "[", 
     RowBox[{
      RowBox[{"ToString", "[", 
       RowBox[{
        RowBox[{"Simplify", "[", 
         RowBox[{"D", "[", 
          RowBox[{"PPi", ",", "y"}], "]"}], "]"}], ",", "CForm"}], "]"}], ",",
       "rules"}], "]"}], ",", "\"\<));\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{
   "\"\<Psi_z_multipatch_error[ijk] = abs(Psi_z_rhs[ijk] - (\>\"", ",", 
    RowBox[{"StringReplace", "[", 
     RowBox[{
      RowBox[{"ToString", "[", 
       RowBox[{
        RowBox[{"Simplify", "[", 
         RowBox[{"D", "[", 
          RowBox[{"PPi", ",", "z"}], "]"}], "]"}], ",", "CForm"}], "]"}], ",",
       "rules"}], "]"}], ",", "\"\<));\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{"\"\<Phi_multipatch_error[ijk] = abs(Phi_rhs[ijk] - (\>\"", ",", 
     RowBox[{"StringReplace", "[", 
      RowBox[{
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"Simplify", "[", "PPi", "]"}], ",", "CForm"}], "]"}], ",", 
       "rules"}], "]"}], ",", "\"\<));\>\""}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"alp", ",", "betax", ",", "betay", ",", "betaz", ",", "detgamma"}],
    "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"F", ",", "Fx", ",", "Fy", ",", "Fz"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.864227571442871*^9, 3.864227698475622*^9}, {
   3.864259663668742*^9, 3.864259671517556*^9}, 3.864259727389339*^9, {
   3.864259758967821*^9, 3.864259905057089*^9}, {3.864260038723153*^9, 
   3.86426009635205*^9}, {3.864260205182518*^9, 3.864260210544786*^9}, {
   3.8642602720014143`*^9, 3.864260328069207*^9}, {3.864260360109911*^9, 
   3.864260393099922*^9}, {3.864260429648452*^9, 3.864260550166051*^9}, {
   3.8642608202180557`*^9, 3.864260914117834*^9}, {3.864260958937278*^9, 
   3.8642609898967953`*^9}, {3.8642616670240088`*^9, 3.864261669560749*^9}, {
   3.864261704984415*^9, 3.864261749309413*^9}, {3.864261913485764*^9, 
   3.864261930645144*^9}, {3.864488291538622*^9, 3.864488417307398*^9}, {
   3.8644884498153048`*^9, 3.864488515394168*^9}, {3.864488632953668*^9, 
   3.864488655652236*^9}, {3.864505129577285*^9, 3.8645051355989437`*^9}, {
   3.86450559482808*^9, 3.8645056048574657`*^9}, {3.864505643018474*^9, 
   3.864505671595778*^9}, {3.864505741594612*^9, 3.86450574850381*^9}, {
   3.864506066057535*^9, 3.864506074486765*^9}, {3.864506106918054*^9, 
   3.86450627185264*^9}, {3.8645067260647182`*^9, 3.8645067351932163`*^9}, {
   3.864511193002102*^9, 3.86451125544066*^9}, {3.864511526844365*^9, 
   3.864511617720278*^9}, {3.864512549631435*^9, 3.8645125722098846`*^9}, {
   3.864512602570641*^9, 3.8645126281014442`*^9}, {3.864512726509018*^9, 
   3.864512746895588*^9}, {3.8645127990073233`*^9, 3.864512799465032*^9}, {
   3.864513051841878*^9, 3.864513095968309*^9}, {3.8645133646642303`*^9, 
   3.864513374432705*^9}, {3.864515056572948*^9, 3.864515069750774*^9}, {
   3.864515331448613*^9, 3.864515346086893*^9}, 3.864515431648003*^9, {
   3.8645154709179697`*^9, 3.864515471176607*^9}, {3.8645155189076643`*^9, 
   3.864515519975182*^9}},
 CellLabel->
  "In[247]:=",ExpressionUUID->"a7b86eff-d2a4-4311-8a54-f1c07c42ea0f"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Pi_multipatch_error[ijk] = abs(Pi_rhs[ijk] - (\"\>", 
   "\[InvisibleSpace]", "\<\"cos(2*M_PI*((x[ijk] - \
space_offset[0])*wave_number[0] + (y[ijk] - space_offset[1])*wave_number[1] + \
(z[ijk] - space_offset[2])*wave_number[2] + (t - \
time_offset)*sqrt(pow(wave_number[0],2) + pow(wave_number[1],2) + \
pow(wave_number[2],2))))*(pow(field_mass,2) + \
4*pow(M_PI,2)*(pow(wave_number[0],2) + pow(wave_number[1],2) + \
pow(wave_number[2],2)))\"\>", "\[InvisibleSpace]", "\<\"));\"\>"}],
  SequenceForm[
  "Pi_multipatch_error[ijk] = abs(Pi_rhs[ijk] - (", 
   "cos(2*M_PI*((x[ijk] - space_offset[0])*wave_number[0] + (y[ijk] - \
space_offset[1])*wave_number[1] + (z[ijk] - space_offset[2])*wave_number[2] + \
(t - time_offset)*sqrt(pow(wave_number[0],2) + pow(wave_number[1],2) + \
pow(wave_number[2],2))))*(pow(field_mass,2) + \
4*pow(M_PI,2)*(pow(wave_number[0],2) + pow(wave_number[1],2) + \
pow(wave_number[2],2)))", "));"],
  Editable->False]], "Print",
 CellChangeTimes->{3.864515348222786*^9, 3.864515434050785*^9, 
  3.864515476475613*^9, 3.8645155464643784`*^9},
 CellLabel->
  "During evaluation of \
In[247]:=",ExpressionUUID->"566cd51b-2afe-49a0-bbcc-8f823a4fc812"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Psi_x_multipatch_error[ijk] = abs(Psi_x_rhs[ijk] - (\"\>", 
   "\[InvisibleSpace]", "\<\"4*pow(M_PI,2)*cos(2*M_PI*((x[ijk] - \
space_offset[0])*wave_number[0] + (y[ijk] - space_offset[1])*wave_number[1] + \
(z[ijk] - space_offset[2])*wave_number[2] + (t - \
time_offset)*sqrt(pow(wave_number[0],2) + pow(wave_number[1],2) + \
pow(wave_number[2],2))))*wave_number[0]*sqrt(pow(wave_number[0],2) + \
pow(wave_number[1],2) + pow(wave_number[2],2))\"\>", 
   "\[InvisibleSpace]", "\<\"));\"\>"}],
  SequenceForm[
  "Psi_x_multipatch_error[ijk] = abs(Psi_x_rhs[ijk] - (", 
   "4*pow(M_PI,2)*cos(2*M_PI*((x[ijk] - space_offset[0])*wave_number[0] + \
(y[ijk] - space_offset[1])*wave_number[1] + (z[ijk] - \
space_offset[2])*wave_number[2] + (t - \
time_offset)*sqrt(pow(wave_number[0],2) + pow(wave_number[1],2) + \
pow(wave_number[2],2))))*wave_number[0]*sqrt(pow(wave_number[0],2) + \
pow(wave_number[1],2) + pow(wave_number[2],2))", "));"],
  Editable->False]], "Print",
 CellChangeTimes->{3.864515348222786*^9, 3.864515434050785*^9, 
  3.864515476475613*^9, 3.8645155471707497`*^9},
 CellLabel->
  "During evaluation of \
In[247]:=",ExpressionUUID->"13e6001f-7f52-4463-b6ee-7ad320956c46"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Psi_y_multipatch_error[ijk] = abs(Psi_y_rhs[ijk] - (\"\>", 
   "\[InvisibleSpace]", "\<\"4*pow(M_PI,2)*cos(2*M_PI*((x[ijk] - \
space_offset[0])*wave_number[0] + (y[ijk] - space_offset[1])*wave_number[1] + \
(z[ijk] - space_offset[2])*wave_number[2] + (t - \
time_offset)*sqrt(pow(wave_number[0],2) + pow(wave_number[1],2) + \
pow(wave_number[2],2))))*wave_number[1]*sqrt(pow(wave_number[0],2) + \
pow(wave_number[1],2) + pow(wave_number[2],2))\"\>", 
   "\[InvisibleSpace]", "\<\"));\"\>"}],
  SequenceForm[
  "Psi_y_multipatch_error[ijk] = abs(Psi_y_rhs[ijk] - (", 
   "4*pow(M_PI,2)*cos(2*M_PI*((x[ijk] - space_offset[0])*wave_number[0] + \
(y[ijk] - space_offset[1])*wave_number[1] + (z[ijk] - \
space_offset[2])*wave_number[2] + (t - \
time_offset)*sqrt(pow(wave_number[0],2) + pow(wave_number[1],2) + \
pow(wave_number[2],2))))*wave_number[1]*sqrt(pow(wave_number[0],2) + \
pow(wave_number[1],2) + pow(wave_number[2],2))", "));"],
  Editable->False]], "Print",
 CellChangeTimes->{3.864515348222786*^9, 3.864515434050785*^9, 
  3.864515476475613*^9, 3.864515547905672*^9},
 CellLabel->
  "During evaluation of \
In[247]:=",ExpressionUUID->"978ac66b-715d-4f70-a132-253632f836df"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Psi_z_multipatch_error[ijk] = abs(Psi_z_rhs[ijk] - (\"\>", 
   "\[InvisibleSpace]", "\<\"4*pow(M_PI,2)*cos(2*M_PI*((x[ijk] - \
space_offset[0])*wave_number[0] + (y[ijk] - space_offset[1])*wave_number[1] + \
(z[ijk] - space_offset[2])*wave_number[2] + (t - \
time_offset)*sqrt(pow(wave_number[0],2) + pow(wave_number[1],2) + \
pow(wave_number[2],2))))*wave_number[2]*sqrt(pow(wave_number[0],2) + \
pow(wave_number[1],2) + pow(wave_number[2],2))\"\>", 
   "\[InvisibleSpace]", "\<\"));\"\>"}],
  SequenceForm[
  "Psi_z_multipatch_error[ijk] = abs(Psi_z_rhs[ijk] - (", 
   "4*pow(M_PI,2)*cos(2*M_PI*((x[ijk] - space_offset[0])*wave_number[0] + \
(y[ijk] - space_offset[1])*wave_number[1] + (z[ijk] - \
space_offset[2])*wave_number[2] + (t - \
time_offset)*sqrt(pow(wave_number[0],2) + pow(wave_number[1],2) + \
pow(wave_number[2],2))))*wave_number[2]*sqrt(pow(wave_number[0],2) + \
pow(wave_number[1],2) + pow(wave_number[2],2))", "));"],
  Editable->False]], "Print",
 CellChangeTimes->{3.864515348222786*^9, 3.864515434050785*^9, 
  3.864515476475613*^9, 3.864515548636891*^9},
 CellLabel->
  "During evaluation of \
In[247]:=",ExpressionUUID->"76daa6d1-f628-436c-a4f4-d01af0a5f302"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Phi_multipatch_error[ijk] = abs(Phi_rhs[ijk] - (\"\>", 
   "\[InvisibleSpace]", "\<\"2*M_PI*sin(2*M_PI*((x[ijk] - \
space_offset[0])*wave_number[0] + (y[ijk] - space_offset[1])*wave_number[1] + \
(z[ijk] - space_offset[2])*wave_number[2] + (t - \
time_offset)*sqrt(pow(wave_number[0],2) + pow(wave_number[1],2) + \
pow(wave_number[2],2))))*sqrt(pow(wave_number[0],2) + pow(wave_number[1],2) + \
pow(wave_number[2],2))\"\>", "\[InvisibleSpace]", "\<\"));\"\>"}],
  SequenceForm[
  "Phi_multipatch_error[ijk] = abs(Phi_rhs[ijk] - (", 
   "2*M_PI*sin(2*M_PI*((x[ijk] - space_offset[0])*wave_number[0] + (y[ijk] - \
space_offset[1])*wave_number[1] + (z[ijk] - space_offset[2])*wave_number[2] + \
(t - time_offset)*sqrt(pow(wave_number[0],2) + pow(wave_number[1],2) + \
pow(wave_number[2],2))))*sqrt(pow(wave_number[0],2) + pow(wave_number[1],2) + \
pow(wave_number[2],2))", "));"],
  Editable->False]], "Print",
 CellChangeTimes->{3.864515348222786*^9, 3.864515434050785*^9, 
  3.864515476475613*^9, 3.864515549388074*^9},
 CellLabel->
  "During evaluation of \
In[247]:=",ExpressionUUID->"2eb111ed-5834-47c5-a91f-6df12d4a34a8"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Multipolar gaussian", "Title",
 CellChangeTimes->{{3.863136976542345*^9, 3.86313698399121*^9}, {
  3.864224735609383*^9, 3.8642247372894087`*^9}, {3.864747922383258*^9, 
  3.864747926143132*^9}},ExpressionUUID->"b9fd0c82-353f-4ab6-8982-\
26a060bc1758"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"$Assumptions", "=", 
    RowBox[{
     RowBox[{"x", "\[Element]", "Reals"}], "&&", 
     RowBox[{"y", "\[Element]", "Reals"}], "&&", 
     RowBox[{"z", "\[Element]", "Reals"}], "&&", 
     RowBox[{"r", "\[Element]", "Reals"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "baseGaussian", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"baseGaussian", "[", 
     RowBox[{"r_", ",", "sigma_"}], "]"}], "=", 
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"r", "^", "2"}]}], "/", 
      RowBox[{"(", 
       RowBox[{"2", 
        RowBox[{"sigma", "^", "2"}]}], ")"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "realSphericalHarmonics", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"realSphericalHarmonics", "[", 
     RowBox[{"l_", ",", "m_", ",", "\[Theta]_", ",", "\[Phi]_"}], "]"}], "=", 
    "\[IndentingNewLine]", 
    RowBox[{"Piecewise", "[", "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"FullSimplify", "[", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}], "m"], 
           RowBox[{"LegendreP", "[", 
            RowBox[{"l", ",", 
             RowBox[{"Abs", "[", "m", "]"}], ",", 
             RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "]"}], 
           RowBox[{"Sin", "[", 
            RowBox[{
             RowBox[{"Abs", "[", "m", "]"}], "\[Phi]"}], "]"}]}], "]"}], ",", 
         
         RowBox[{"m", "<", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"FullSimplify", "[", 
          RowBox[{"LegendreP", "[", 
           RowBox[{"l", ",", "m", ",", 
            RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "]"}], "]"}], ",", 
         RowBox[{"m", "\[Equal]", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"{", 
        RowBox[{
         RowBox[{"FullSimplify", "[", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}], "m"], 
           RowBox[{"LegendreP", "[", 
            RowBox[{"l", ",", "m", ",", 
             RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "]"}], 
           RowBox[{"Cos", "[", 
            RowBox[{"m", "*", "\[Phi]"}], "]"}]}], "]"}], ",", 
         RowBox[{"m", ">", "0"}]}], "}"}]}], "\[IndentingNewLine]", "}"}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "smoothAtan2", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"smoothAtan2", "[", 
     RowBox[{"y_", ",", "x_"}], "]"}], "=", 
    RowBox[{"Piecewise", "[", "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{
          RowBox[{"x", "\[Equal]", "0"}], "&&", 
          RowBox[{"y", "\[Equal]", "0"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ArcTan", "[", 
          RowBox[{"x", ",", "y"}], "]"}], ",", "True"}], "}"}]}], 
      "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "shSum", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"shSum", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"TrigExpand", "[", 
       RowBox[{
        RowBox[{"c", "[", 
         RowBox[{"l", ",", "m"}], "]"}], 
        RowBox[{"realSphericalHarmonics", "[", 
         RowBox[{"l", ",", "m", ",", 
          RowBox[{"ArcCos", "[", 
           FractionBox["z", 
            SqrtBox[
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}]]], "]"}], ",", 
          RowBox[{"smoothAtan2", "[", 
           RowBox[{"y", ",", "x"}], "]"}]}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"l", ",", "0", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", 
        RowBox[{"-", "l"}], ",", "l"}], "}"}]}], "]"}], ",", 
    RowBox[{"Flatten", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"c", "[", 
        RowBox[{"l", ",", "m"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "0", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"m", ",", 
         RowBox[{"-", "l"}], ",", "l"}], "}"}]}], "]"}], "]"}], ",", 
    "FullSimplify"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.864826943374075*^9, 3.864827020513906*^9}, {
   3.8648272451876574`*^9, 3.864827369833222*^9}, {3.8648274013239727`*^9, 
   3.864827418132567*^9}, {3.864828247054788*^9, 3.864828391380361*^9}, {
   3.86482865005577*^9, 3.864828713212638*^9}, {3.8648287697916727`*^9, 
   3.8648287706915407`*^9}, {3.864828839189808*^9, 3.864828927678359*^9}, {
   3.864828989887085*^9, 3.864828999028948*^9}, {3.864829049735248*^9, 
   3.864829051794969*^9}, {3.864829113125514*^9, 3.864829207702794*^9}, {
   3.864833032486827*^9, 3.864833277410528*^9}, {3.864833318279841*^9, 
   3.864833320899309*^9}, {3.864833372709216*^9, 3.864833689803493*^9}, {
   3.8648571437444773`*^9, 3.864857166612404*^9}, {3.864857216511676*^9, 
   3.864857261860141*^9}, {3.864857298660863*^9, 3.8648572991701937`*^9}, {
   3.864857707724703*^9, 3.86485780710118*^9}, {3.8648579119896307`*^9, 
   3.864857914549302*^9}, {3.864907294622089*^9, 3.864907323290883*^9}, {
   3.864907577698403*^9, 3.864907640467402*^9}, {3.864907680007307*^9, 
   3.8649078121370277`*^9}, {3.8649078500790167`*^9, 3.864907857169581*^9}, {
   3.864907905038433*^9, 3.86490790646673*^9}, {3.864907967536727*^9, 
   3.864908055445242*^9}, {3.864908088954194*^9, 3.864908098471219*^9}, {
   3.864908152459503*^9, 3.8649081795180397`*^9}, {3.864908452091563*^9, 
   3.8649084522694063`*^9}, {3.864908725075604*^9, 3.864908726546413*^9}, {
   3.8649088154733458`*^9, 3.8649088448703547`*^9}, {3.8649089263708897`*^9, 
   3.86490894297852*^9}, {3.864908991090217*^9, 3.864908997967126*^9}, {
   3.8649092891064*^9, 3.864909396500814*^9}, {3.8649094325015097`*^9, 
   3.864909433111495*^9}, 3.86490999098532*^9, {3.86491430189118*^9, 
   3.8649144125301228`*^9}, {3.864914445897784*^9, 3.8649145322150173`*^9}, {
   3.864914590946603*^9, 3.8649146200244293`*^9}, {3.8649146537056427`*^9, 
   3.8649147678616323`*^9}, {3.864914903329829*^9, 3.86491498510797*^9}, {
   3.864915021220015*^9, 3.864915052948566*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"8160b79c-bc6e-4749-8abe-131238ef680b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"c", "[", 
   RowBox[{"0", ",", "0"}], "]"}], "+", 
  FractionBox[
   RowBox[{"z", " ", 
    RowBox[{"c", "[", 
     RowBox[{"1", ",", "0"}], "]"}]}], 
   SqrtBox[
    RowBox[{
     SuperscriptBox["x", "2"], "+", 
     SuperscriptBox["y", "2"], "+", 
     SuperscriptBox["z", "2"]}]]], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{"3", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"]}], ")"}]}], 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"], "+", 
         SuperscriptBox["z", "2"]}], ")"}]}]]}], ")"}], " ", 
   RowBox[{"c", "[", 
    RowBox[{"2", ",", "0"}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"c", "[", 
    RowBox[{"2", ",", "2"}], "]"}], " ", 
   RowBox[{"(", 
    TagBox[GridBox[{
       {"\[Piecewise]", GridBox[{
          {"0", 
           RowBox[{
            RowBox[{"x", "\[Equal]", "0"}], "&&", 
            RowBox[{"y", "\[Equal]", "0"}]}]},
          {
           FractionBox[
            RowBox[{"3", " ", 
             RowBox[{"(", 
              RowBox[{"x", "-", "y"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"x", "+", "y"}], ")"}]}], 
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}]], 
           TagBox["True",
            "PiecewiseDefault",
            AutoDelete->True]}
         },
         AllowedDimensions->{2, Automatic},
         Editable->True,
         GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
         GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.84]}, 
             Offset[0.27999999999999997`]}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}},
         Selectable->True]}
      },
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.35]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}],
     "Piecewise",
     DeleteWithContents->True,
     Editable->False,
     SelectWithContents->True,
     Selectable->False,
     StripWrapperBoxes->True], ")"}]}], "+", 
  RowBox[{
   RowBox[{"c", "[", 
    RowBox[{"1", ",", "1"}], "]"}], " ", 
   RowBox[{"(", 
    TagBox[GridBox[{
       {"\[Piecewise]", GridBox[{
          {"0", 
           RowBox[{
            RowBox[{"x", "\[Equal]", "0"}], "&&", 
            RowBox[{"y", "\[Equal]", "0"}]}]},
          {
           FractionBox["x", 
            SqrtBox[
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}]]], 
           TagBox["True",
            "PiecewiseDefault",
            AutoDelete->True]}
         },
         AllowedDimensions->{2, Automatic},
         Editable->True,
         GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
         GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.84]}, 
             Offset[0.27999999999999997`]}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}},
         Selectable->True]}
      },
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.35]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}],
     "Piecewise",
     DeleteWithContents->True,
     Editable->False,
     SelectWithContents->True,
     Selectable->False,
     StripWrapperBoxes->True], ")"}]}], "+", 
  RowBox[{
   RowBox[{"c", "[", 
    RowBox[{"2", ",", 
     RowBox[{"-", "2"}]}], "]"}], " ", 
   RowBox[{"(", 
    TagBox[GridBox[{
       {"\[Piecewise]", GridBox[{
          {
           FractionBox[
            RowBox[{"6", " ", "x", " ", "y"}], 
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}]], 
           RowBox[{
            RowBox[{"x", "\[NotEqual]", "0"}], "||", 
            RowBox[{"y", "\[NotEqual]", "0"}]}]},
          {"0", 
           TagBox["True",
            "PiecewiseDefault",
            AutoDelete->True]}
         },
         AllowedDimensions->{2, Automatic},
         Editable->True,
         GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
         GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.84]}, 
             Offset[0.27999999999999997`]}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}},
         Selectable->True]}
      },
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.35]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}],
     "Piecewise",
     DeleteWithContents->True,
     Editable->False,
     SelectWithContents->True,
     Selectable->False,
     StripWrapperBoxes->True], ")"}]}], "+", 
  RowBox[{
   RowBox[{"c", "[", 
    RowBox[{"2", ",", "1"}], "]"}], " ", 
   RowBox[{"(", 
    TagBox[GridBox[{
       {"\[Piecewise]", GridBox[{
          {
           FractionBox[
            RowBox[{"3", " ", "x", " ", "z"}], 
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}]], 
           RowBox[{
            RowBox[{"x", "\[NotEqual]", "0"}], "||", 
            RowBox[{"y", "\[NotEqual]", "0"}]}]},
          {"0", 
           TagBox["True",
            "PiecewiseDefault",
            AutoDelete->True]}
         },
         AllowedDimensions->{2, Automatic},
         Editable->True,
         GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
         GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.84]}, 
             Offset[0.27999999999999997`]}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}},
         Selectable->True]}
      },
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.35]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}],
     "Piecewise",
     DeleteWithContents->True,
     Editable->False,
     SelectWithContents->True,
     Selectable->False,
     StripWrapperBoxes->True], ")"}]}], "+", 
  RowBox[{
   RowBox[{"c", "[", 
    RowBox[{"2", ",", 
     RowBox[{"-", "1"}]}], "]"}], " ", 
   RowBox[{"(", 
    TagBox[GridBox[{
       {"\[Piecewise]", GridBox[{
          {
           FractionBox[
            RowBox[{"3", " ", "y", " ", "z"}], 
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}]], 
           RowBox[{
            RowBox[{"x", "\[NotEqual]", "0"}], "||", 
            RowBox[{"y", "\[NotEqual]", "0"}]}]},
          {"0", 
           TagBox["True",
            "PiecewiseDefault",
            AutoDelete->True]}
         },
         AllowedDimensions->{2, Automatic},
         Editable->True,
         GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
         GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.84]}, 
             Offset[0.27999999999999997`]}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}},
         Selectable->True]}
      },
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.35]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}],
     "Piecewise",
     DeleteWithContents->True,
     Editable->False,
     SelectWithContents->True,
     Selectable->False,
     StripWrapperBoxes->True], ")"}]}], "+", 
  RowBox[{
   RowBox[{"c", "[", 
    RowBox[{"1", ",", 
     RowBox[{"-", "1"}]}], "]"}], " ", 
   RowBox[{"(", 
    TagBox[GridBox[{
       {"\[Piecewise]", GridBox[{
          {
           FractionBox["y", 
            SqrtBox[
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}]]], 
           RowBox[{
            RowBox[{"x", "\[NotEqual]", "0"}], "||", 
            RowBox[{"y", "\[NotEqual]", "0"}]}]},
          {"0", 
           TagBox["True",
            "PiecewiseDefault",
            AutoDelete->True]}
         },
         AllowedDimensions->{2, Automatic},
         Editable->True,
         GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
         GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.84]}, 
             Offset[0.27999999999999997`]}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}},
         Selectable->True]}
      },
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.35]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}],
     "Piecewise",
     DeleteWithContents->True,
     Editable->False,
     SelectWithContents->True,
     Selectable->False,
     StripWrapperBoxes->True], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.864909991774748*^9, 3.864910171292158*^9, 3.8649131565921717`*^9, {
   3.8649143210061703`*^9, 3.864914413202417*^9}, {3.864914458539168*^9, 
   3.864914532955986*^9}, {3.864914591618917*^9, 3.864914620732491*^9}, {
   3.8649146548887367`*^9, 3.86491469721115*^9}, {3.864914730140665*^9, 
   3.864914768545285*^9}, {3.864914912455785*^9, 3.864914985904892*^9}, {
   3.8649150258786697`*^9, 3.864915053890299*^9}, 3.864916039031035*^9},
 CellLabel->"Out[9]=",ExpressionUUID->"49c5ed1a-e305-4182-b2d0-0a0e2a9156d9"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "rules", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rules", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<c(0,0)\>\"", "\[Rule]", "\"\<c[0]\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<c(1,-1)\>\"", "\[Rule]", "\"\<c[1]\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<c(1,0)\>\"", "\[Rule]", "\"\<c[2]\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<c(1,1)\>\"", "\[Rule]", "\"\<c[3]\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<c(2,-2)\>\"", "\[Rule]", "\"\<c[4]\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<c(2,-1)\>\"", "\[Rule]", "\"\<c[5]\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<c(2,0)\>\"", "\[Rule]", "\"\<c[6]\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<c(2,1)\>\"", "\[Rule]", "\"\<c[7]\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<c(2,2)\>\"", "\[Rule]", "\"\<c[8]\>\""}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<Sqrt(Power(x,2) + Power(y,2) + Power(z,2))\>\"", "\[Rule]", 
      "\"\<r\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<Power(x,2) + Power(y,2) + Power(z,2)\>\"", "\[Rule]", 
      "\"\<r2\>\""}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"\"\<Power\>\"", "\[Rule]", "\"\<pow\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<Sqrt\>\"", "\[Rule]", "\"\<sqrt\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<Sign\>\"", "\[Rule]", "\"\<sign\>\""}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8649100677227707`*^9, 3.864910132378385*^9}, {
  3.864910172558496*^9, 3.864910176659739*^9}, {3.864910418327582*^9, 
  3.8649104925852747`*^9}, {3.8649105573846483`*^9, 3.86491062267102*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"a3183efa-6acc-48e9-a951-3390299f1ea6"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"StringReplace", "[", 
  RowBox[{
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"FullSimplify", "[", 
      RowBox[{"shSum", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x", "==", "0"}], ",", 
         RowBox[{"y", "==", "0"}]}], "}"}]}], "]"}], ",", "CForm"}], "]"}], 
   ",", "rules"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"StringReplace", "[", 
  RowBox[{
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"FullSimplify", "[", 
      RowBox[{"shSum", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x", "==", "0"}], ",", 
         RowBox[{"y", "!=", "0"}]}], "}"}]}], "]"}], ",", "CForm"}], "]"}], 
   ",", "rules"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"StringReplace", "[", 
  RowBox[{
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"FullSimplify", "[", 
      RowBox[{"shSum", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x", "!=", "0"}], ",", 
         RowBox[{"y", "==", "0"}]}], "}"}]}], "]"}], ",", "CForm"}], "]"}], 
   ",", "rules"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"StringReplace", "[", 
  RowBox[{
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"FullSimplify", "[", 
      RowBox[{"shSum", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x", "!=", "0"}], ",", 
         RowBox[{"y", "!=", "0"}]}], "}"}]}], "]"}], ",", "CForm"}], "]"}], 
   ",", "rules"}], "]"}]}], "Input",
 CellChangeTimes->{{3.8649096143598433`*^9, 3.8649096260578003`*^9}, {
  3.8649099704733562`*^9, 3.864910065241021*^9}, {3.8649101626566143`*^9, 
  3.864910209144535*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"3196a6dc-aa2f-453e-bbf5-4eea7ded0c89"],

Cell[BoxData["\<\"c[0] + c[6] + c[2]*sign(z)\"\>"], "Output",
 CellChangeTimes->{{3.864909978045785*^9, 3.864910044465747*^9}, {
   3.86491018090589*^9, 3.864910209763926*^9}, 3.8649104539976397`*^9, 
   3.8649104947311497`*^9, 3.864910570044476*^9, {3.8649106044108686`*^9, 
   3.8649106248068037`*^9}, 3.864913194788797*^9, 3.864916044327106*^9},
 CellLabel->"Out[12]=",ExpressionUUID->"dbcdf7c5-229b-456d-b4a3-3a16c286021d"],

Cell[BoxData["\<\"c[0] + (2*y*(sqrt(pow(y,2) + pow(z,2))*c[1] + 3*z*c[5]) + \
2*z*(sqrt(pow(y,2) + pow(z,2))*c[2] + z*c[6]) - pow(y,2)*(c[6] + \
6*c[8]))/(2.*(pow(y,2) + pow(z,2)))\"\>"], "Output",
 CellChangeTimes->{{3.864909978045785*^9, 3.864910044465747*^9}, {
   3.86491018090589*^9, 3.864910209763926*^9}, 3.8649104539976397`*^9, 
   3.8649104947311497`*^9, 3.864910570044476*^9, {3.8649106044108686`*^9, 
   3.8649106248068037`*^9}, 3.864913194788797*^9, 3.8649160453650427`*^9},
 CellLabel->"Out[13]=",ExpressionUUID->"6e55b978-f47a-4e19-9736-2c244d395518"],

Cell[BoxData["\<\"c[0] + (2*z*sqrt(pow(x,2) + pow(z,2))*c[2] + \
2*x*sqrt(pow(x,2) + pow(z,2))*c[3] - (pow(x,2) - 2*pow(z,2))*c[6] + \
6*x*(z*c[7] + x*c[8]))/(2.*(pow(x,2) + pow(z,2)))\"\>"], "Output",
 CellChangeTimes->{{3.864909978045785*^9, 3.864910044465747*^9}, {
   3.86491018090589*^9, 3.864910209763926*^9}, 3.8649104539976397`*^9, 
   3.8649104947311497`*^9, 3.864910570044476*^9, {3.8649106044108686`*^9, 
   3.8649106248068037`*^9}, 3.864913194788797*^9, 3.864916046376333*^9},
 CellLabel->"Out[14]=",ExpressionUUID->"dbc02bb0-4f2e-4c4f-a266-0f45f5cec393"],

Cell[BoxData["\<\"c[0] + (y*c[1])/r + (z*c[2])/r + (x*c[3])/r - c[6]/2. - \
3*c[8] + (3*(4*x*y*c[4] + 2*y*z*c[5] + pow(z,2)*c[6] + 2*x*z*c[7] + \
2*(2*pow(x,2) + pow(z,2))*c[8]))/(2.*(r2))\"\>"], "Output",
 CellChangeTimes->{{3.864909978045785*^9, 3.864910044465747*^9}, {
   3.86491018090589*^9, 3.864910209763926*^9}, 3.8649104539976397`*^9, 
   3.8649104947311497`*^9, 3.864910570044476*^9, {3.8649106044108686`*^9, 
   3.8649106248068037`*^9}, 3.864913194788797*^9, 3.864916047439959*^9},
 CellLabel->"Out[15]=",ExpressionUUID->"71585c4d-108e-463f-9e65-23823d568e10"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"StringReplace", "[", 
  RowBox[{
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"FullSimplify", "[", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"shSum", ",", "x"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x", "==", "0"}], ",", 
         RowBox[{"y", "==", "0"}]}], "}"}]}], "]"}], ",", "CForm"}], "]"}], 
   ",", "rules"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"StringReplace", "[", 
  RowBox[{
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"FullSimplify", "[", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"shSum", ",", "x"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x", "==", "0"}], ",", 
         RowBox[{"y", "!=", "0"}]}], "}"}]}], "]"}], ",", "CForm"}], "]"}], 
   ",", "rules"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"StringReplace", "[", 
  RowBox[{
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"FullSimplify", "[", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"shSum", ",", "x"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x", "!=", "0"}], ",", 
         RowBox[{"y", "==", "0"}]}], "}"}]}], "]"}], ",", "CForm"}], "]"}], 
   ",", "rules"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"StringReplace", "[", 
  RowBox[{
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"FullSimplify", "[", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"shSum", ",", "x"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x", "!=", "0"}], ",", 
         RowBox[{"y", "!=", "0"}]}], "}"}]}], "]"}], ",", "CForm"}], "]"}], 
   ",", "rules"}], "]"}]}], "Input",
 CellChangeTimes->{{3.8649116543900747`*^9, 3.864911670789791*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"a4eed23a-2d1b-41a6-accb-53f3740e5c6d"],

Cell[BoxData["\<\"0\"\>"], "Output",
 CellChangeTimes->{3.8649116727347393`*^9, 3.864916047587224*^9},
 CellLabel->"Out[16]=",ExpressionUUID->"52e2f5fc-dc93-4344-8780-07e08f1e9b78"],

Cell[BoxData["\<\"(sqrt(pow(y,2) + pow(z,2))*c[3] + 6*y*c[4] + \
3*z*c[7])/(pow(y,2) + pow(z,2))\"\>"], "Output",
 CellChangeTimes->{3.8649116727347393`*^9, 3.864916047725459*^9},
 CellLabel->"Out[17]=",ExpressionUUID->"bb611b7c-8a94-44a7-ba52-53e1b9abed2c"],

Cell[BoxData["\<\"(z*(-(pow(x,3)*c[2]) + pow(x,2)*(z*c[3] - 3*sqrt(pow(x,2) + \
pow(z,2))*c[7]) + pow(z,2)*(z*c[3] + 3*sqrt(pow(x,2) + pow(z,2))*c[7]) - \
x*z*(z*c[2] + 3*sqrt(pow(x,2) + pow(z,2))*(c[6] - 2*c[8]))))/pow(pow(x,2) + \
pow(z,2),2.5)\"\>"], "Output",
 CellChangeTimes->{3.8649116727347393`*^9, 3.8649160482151537`*^9},
 CellLabel->"Out[18]=",ExpressionUUID->"22f31a52-688f-4357-99bc-0e4cfca7f5dc"],

Cell[BoxData["\<\"(-3*pow(x,2)*(2*y*c[4] + z*c[7]) + (pow(y,2) + \
pow(z,2))*(r*c[3] + 6*y*c[4] + 3*z*c[7]) - x*(y*r*c[1] + z*r*c[2] + \
6*y*z*c[5] + 3*pow(z,2)*(c[6] - 2*c[8]) - 12*pow(y,2)*c[8]))/pow(r2,2)\"\>"], \
"Output",
 CellChangeTimes->{3.8649116727347393`*^9, 3.864916048664021*^9},
 CellLabel->"Out[19]=",ExpressionUUID->"599b46c1-0c2d-4115-925c-73f7aed6645c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"StringReplace", "[", 
  RowBox[{
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"FullSimplify", "[", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"shSum", ",", "y"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x", "==", "0"}], ",", 
         RowBox[{"y", "==", "0"}]}], "}"}]}], "]"}], ",", "CForm"}], "]"}], 
   ",", "rules"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"StringReplace", "[", 
  RowBox[{
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"FullSimplify", "[", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"shSum", ",", "y"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x", "==", "0"}], ",", 
         RowBox[{"y", "!=", "0"}]}], "}"}]}], "]"}], ",", "CForm"}], "]"}], 
   ",", "rules"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"StringReplace", "[", 
  RowBox[{
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"FullSimplify", "[", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"shSum", ",", "y"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x", "!=", "0"}], ",", 
         RowBox[{"y", "==", "0"}]}], "}"}]}], "]"}], ",", "CForm"}], "]"}], 
   ",", "rules"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"StringReplace", "[", 
  RowBox[{
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"FullSimplify", "[", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"shSum", ",", "y"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x", "!=", "0"}], ",", 
         RowBox[{"y", "!=", "0"}]}], "}"}]}], "]"}], ",", "CForm"}], "]"}], 
   ",", "rules"}], "]"}]}], "Input",
 CellChangeTimes->{{3.864911801107814*^9, 3.864911804096985*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"dfb168da-25ff-4899-8edf-63f0fb3b13f4"],

Cell[BoxData["\<\"0\"\>"], "Output",
 CellChangeTimes->{3.864911804480741*^9, 3.864916050054831*^9},
 CellLabel->"Out[20]=",ExpressionUUID->"8f968f43-366c-4681-b79c-2552f345cd07"],

Cell[BoxData["\<\"(z*(-(pow(y,3)*c[2]) + pow(y,2)*(z*c[1] - 3*sqrt(pow(y,2) + \
pow(z,2))*c[5]) + pow(z,2)*(z*c[1] + 3*sqrt(pow(y,2) + pow(z,2))*c[5]) - \
y*z*(z*c[2] + 3*sqrt(pow(y,2) + pow(z,2))*(c[6] + 2*c[8]))))/pow(pow(y,2) + \
pow(z,2),2.5)\"\>"], "Output",
 CellChangeTimes->{3.864911804480741*^9, 3.86491605054277*^9},
 CellLabel->"Out[21]=",ExpressionUUID->"9ffa92ae-2552-4ee2-8334-adb73d96cdea"],

Cell[BoxData["\<\"(sqrt(pow(x,2) + pow(z,2))*c[1] + 6*x*c[4] + \
3*z*c[5])/(pow(x,2) + pow(z,2))\"\>"], "Output",
 CellChangeTimes->{3.864911804480741*^9, 3.8649160506725616`*^9},
 CellLabel->"Out[22]=",ExpressionUUID->"a0c79c53-f8da-4d5f-aa81-80a3da040cb8"],

Cell[BoxData["\<\"-((-((pow(x,2) + pow(z,2))*r*c[1]) + y*z*r*c[2] + \
x*y*r*c[3] - 6*x*(pow(x,2) - pow(y,2) + pow(z,2))*c[4] - 3*z*(pow(x,2) - \
pow(y,2) + pow(z,2))*c[5] + 3*y*pow(z,2)*c[6] + 6*x*y*z*c[7] + \
6*y*(2*pow(x,2) + pow(z,2))*c[8])/pow(r2,2))\"\>"], "Output",
 CellChangeTimes->{3.864911804480741*^9, 3.864916051404196*^9},
 CellLabel->"Out[23]=",ExpressionUUID->"ea9d52d0-661f-4f49-ae41-81921326af31"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"StringReplace", "[", 
  RowBox[{
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"FullSimplify", "[", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"shSum", ",", "z"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x", "==", "0"}], ",", 
         RowBox[{"y", "==", "0"}]}], "}"}]}], "]"}], ",", "CForm"}], "]"}], 
   ",", "rules"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"StringReplace", "[", 
  RowBox[{
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"FullSimplify", "[", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"shSum", ",", "z"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x", "==", "0"}], ",", 
         RowBox[{"y", "!=", "0"}]}], "}"}]}], "]"}], ",", "CForm"}], "]"}], 
   ",", "rules"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"StringReplace", "[", 
  RowBox[{
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"FullSimplify", "[", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"shSum", ",", "z"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x", "!=", "0"}], ",", 
         RowBox[{"y", "==", "0"}]}], "}"}]}], "]"}], ",", "CForm"}], "]"}], 
   ",", "rules"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"StringReplace", "[", 
  RowBox[{
   RowBox[{"ToString", "[", 
    RowBox[{
     RowBox[{"FullSimplify", "[", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"shSum", ",", "z"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x", "!=", "0"}], ",", 
         RowBox[{"y", "!=", "0"}]}], "}"}]}], "]"}], ",", "CForm"}], "]"}], 
   ",", "rules"}], "]"}]}], "Input",
 CellChangeTimes->{{3.864911868356975*^9, 3.864911870366315*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"f85f43a6-6f7e-4239-ab16-f5bd62bbaef1"],

Cell[BoxData["\<\"0\"\>"], "Output",
 CellChangeTimes->{3.86491187081039*^9, 3.8649160524502287`*^9},
 CellLabel->"Out[24]=",ExpressionUUID->"b3e1c574-760b-442d-af2a-8ceaddd9dcb5"],

Cell[BoxData["\<\"(y*(pow(y,3)*c[2] + pow(y,2)*(-(z*c[1]) + 3*sqrt(pow(y,2) + \
pow(z,2))*c[5]) - pow(z,2)*(z*c[1] + 3*sqrt(pow(y,2) + pow(z,2))*c[5]) + \
y*z*(z*c[2] + 3*sqrt(pow(y,2) + pow(z,2))*(c[6] + 2*c[8]))))/pow(pow(y,2) + \
pow(z,2),2.5)\"\>"], "Output",
 CellChangeTimes->{3.86491187081039*^9, 3.864916052878285*^9},
 CellLabel->"Out[25]=",ExpressionUUID->"05f6ce97-2dc9-474a-8360-34e30ad6799b"],

Cell[BoxData["\<\"(x*(pow(x,3)*c[2] + pow(x,2)*(-(z*c[3]) + 3*sqrt(pow(x,2) + \
pow(z,2))*c[7]) - pow(z,2)*(z*c[3] + 3*sqrt(pow(x,2) + pow(z,2))*c[7]) + \
x*z*(z*c[2] + 3*sqrt(pow(x,2) + pow(z,2))*(c[6] - 2*c[8]))))/pow(pow(x,2) + \
pow(z,2),2.5)\"\>"], "Output",
 CellChangeTimes->{3.86491187081039*^9, 3.864916053280753*^9},
 CellLabel->"Out[26]=",ExpressionUUID->"59d64d86-330c-4b4d-90dc-1cc9da094346"],

Cell[BoxData["\<\"-((y*z*r*c[1] + pow(z,2)*r*c[2] - pow(r2,1.5)*c[2] + \
x*z*r*c[3] + 12*x*y*z*c[4] - 3*y*(pow(x,2) + pow(y,2) - pow(z,2))*c[5] - \
3*(pow(x,2) + pow(y,2))*z*c[6] - 3*x*(pow(x,2) + pow(y,2) - pow(z,2))*c[7] + \
6*(x - y)*(x + y)*z*c[8])/pow(r2,2))\"\>"], "Output",
 CellChangeTimes->{3.86491187081039*^9, 3.864916054056625*^9},
 CellLabel->"Out[27]=",ExpressionUUID->"585e4503-8187-4b0d-9f2a-4a30c0e08f68"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1502.608695652174, 788.0869565217392},
WindowMargins->{{1502.608695652174, Automatic}, {
  Automatic, 22.945054945054945`}},
PrintingCopies->1,
PrintingPageRange->{1, Automatic},
ShowSelection->True,
TaggingRules->{
 "WelcomeScreenSettings" -> {"FEStarting" -> False}, "TryRealOnly" -> False},
FrontEndVersion->"12.1 for Linux x86 (64-bit) (June 19, 2020)",
StyleDefinitions->FrontEnd`FileName[{"Creative"}, "NaturalColor.nb", 
  CharacterEncoding -> "UTF-8"],
ExpressionUUID->"e9fbdf28-66ce-4359-b2d9-587b79f04be9"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[422, 15, 156, 3, 61, "Title",ExpressionUUID->"f0b4a695-9791-42ab-84b3-b31a804a95d8"],
Cell[581, 20, 1182, 36, 127, "Input",ExpressionUUID->"fc1751de-e353-4420-92be-718e709e4523"],
Cell[CellGroupData[{
Cell[1788, 60, 6793, 162, 763, "Input",ExpressionUUID->"5428011b-1558-407c-a8b9-2760a421d5c0"],
Cell[CellGroupData[{
Cell[8606, 226, 852, 18, 44, "Print",ExpressionUUID->"8b5e43b1-264a-445d-b9ae-2163a3f080bf"],
Cell[9461, 246, 562, 14, 23, "Print",ExpressionUUID->"f9ae0ed5-3b7f-4277-82eb-d828b2ab6171"],
Cell[10026, 262, 562, 14, 23, "Print",ExpressionUUID->"335b6087-4a11-49e5-9c4c-41293a9b15ab"],
Cell[10591, 278, 564, 14, 23, "Print",ExpressionUUID->"8d2d328d-695e-49ac-9378-0043f4fe4b6c"],
Cell[11158, 294, 514, 12, 23, "Print",ExpressionUUID->"1d25621a-1091-41ee-bcfe-0a563ba4a1a8"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[11733, 313, 203, 4, 35, "Title",ExpressionUUID->"4f9e3ae7-b75c-446f-bec8-6846e2eedc4c"],
Cell[CellGroupData[{
Cell[11961, 321, 10105, 243, 1156, "Input",ExpressionUUID->"dcf2497d-8e8a-43e1-906f-782b7d73ee27"],
Cell[CellGroupData[{
Cell[22091, 568, 1264, 25, 63, "Print",ExpressionUUID->"b75851e4-9263-4728-8d16-341ec52f968f"],
Cell[23358, 595, 910, 19, 44, "Print",ExpressionUUID->"806d6857-bacc-4c46-b883-2a57bd887910"],
Cell[24271, 616, 908, 19, 44, "Print",ExpressionUUID->"89057223-7799-4cae-b87e-07e81d223821"],
Cell[25182, 637, 908, 19, 44, "Print",ExpressionUUID->"f2fe2acd-fe9e-41a5-a0cb-2c07b0a92f77"],
Cell[26093, 658, 856, 18, 44, "Print",ExpressionUUID->"7a95ac2d-d747-4ede-859e-0007b2e9bdbd"]
}, Open  ]]
}, Open  ]],
Cell[26976, 680, 216, 5, 30, "Text",ExpressionUUID->"3be7ae37-78c0-4ed5-96ad-e62616898bd3"],
Cell[CellGroupData[{
Cell[27217, 689, 5688, 133, 494, "Input",ExpressionUUID->"a7b86eff-d2a4-4311-8a54-f1c07c42ea0f"],
Cell[CellGroupData[{
Cell[32930, 826, 1225, 23, 63, "Print",ExpressionUUID->"566cd51b-2afe-49a0-bbcc-8f823a4fc812"],
Cell[34158, 851, 1233, 23, 63, "Print",ExpressionUUID->"13e6001f-7f52-4463-b6ee-7ad320956c46"],
Cell[35394, 876, 1231, 23, 63, "Print",ExpressionUUID->"978ac66b-715d-4f70-a132-253632f836df"],
Cell[36628, 901, 1231, 23, 63, "Print",ExpressionUUID->"76daa6d1-f628-436c-a4f4-d01af0a5f302"],
Cell[37862, 926, 1173, 21, 63, "Print",ExpressionUUID->"2eb111ed-5834-47c5-a91f-6df12d4a34a8"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[39096, 954, 258, 4, 35, "Title",ExpressionUUID->"b9fd0c82-353f-4ab6-8982-26a060bc1758"],
Cell[CellGroupData[{
Cell[39379, 962, 6860, 164, 598, "Input",ExpressionUUID->"8160b79c-bc6e-4749-8abe-131238ef680b"],
Cell[46242, 1128, 11688, 338, 119, "Output",ExpressionUUID->"49c5ed1a-e305-4182-b2d0-0a0e2a9156d9"]
}, Open  ]],
Cell[57945, 1469, 1950, 40, 412, "Input",ExpressionUUID->"a3183efa-6acc-48e9-a951-3390299f1ea6"],
Cell[CellGroupData[{
Cell[59920, 1513, 1672, 48, 104, "Input",ExpressionUUID->"3196a6dc-aa2f-453e-bbf5-4eea7ded0c89"],
Cell[61595, 1563, 427, 5, 41, "Output",ExpressionUUID->"dbcdf7c5-229b-456d-b4a3-3a16c286021d"],
Cell[62025, 1570, 565, 7, 41, "Output",ExpressionUUID->"6e55b978-f47a-4e19-9736-2c244d395518"],
Cell[62593, 1579, 567, 7, 41, "Output",ExpressionUUID->"dbc02bb0-4f2e-4c4f-a266-0f45f5cec393"],
Cell[63163, 1588, 571, 7, 41, "Output",ExpressionUUID->"71585c4d-108e-463f-9e65-23823d568e10"]
}, Open  ]],
Cell[CellGroupData[{
Cell[63771, 1600, 1816, 54, 104, "Input",ExpressionUUID->"a4eed23a-2d1b-41a6-accb-53f3740e5c6d"],
Cell[65590, 1656, 181, 2, 41, "Output",ExpressionUUID->"52e2f5fc-dc93-4344-8780-07e08f1e9b78"],
Cell[65774, 1660, 258, 3, 41, "Output",ExpressionUUID->"bb611b7c-8a94-44a7-ba52-53e1b9abed2c"],
Cell[66035, 1665, 410, 5, 62, "Output",ExpressionUUID->"22f31a52-688f-4357-99bc-0e4cfca7f5dc"],
Cell[66448, 1672, 371, 5, 62, "Output",ExpressionUUID->"599b46c1-0c2d-4115-925c-73f7aed6645c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[66856, 1682, 1814, 54, 104, "Input",ExpressionUUID->"dfb168da-25ff-4899-8edf-63f0fb3b13f4"],
Cell[68673, 1738, 179, 2, 41, "Output",ExpressionUUID->"8f968f43-366c-4681-b79c-2552f345cd07"],
Cell[68855, 1742, 405, 5, 62, "Output",ExpressionUUID->"9ffa92ae-2552-4ee2-8334-adb73d96cdea"],
Cell[69263, 1749, 258, 3, 41, "Output",ExpressionUUID->"a0c79c53-f8da-4d5f-aa81-80a3da040cb8"],
Cell[69524, 1754, 414, 5, 62, "Output",ExpressionUUID->"ea9d52d0-661f-4f49-ae41-81921326af31"]
}, Open  ]],
Cell[CellGroupData[{
Cell[69975, 1764, 1814, 54, 104, "Input",ExpressionUUID->"f85f43a6-6f7e-4239-ab16-f5bd62bbaef1"],
Cell[71792, 1820, 180, 2, 41, "Output",ExpressionUUID->"b3e1c574-760b-442d-af2a-8ceaddd9dcb5"],
Cell[71975, 1824, 405, 5, 62, "Output",ExpressionUUID->"05f6ce97-2dc9-474a-8360-34e30ad6799b"],
Cell[72383, 1831, 405, 5, 62, "Output",ExpressionUUID->"59d64d86-330c-4b4d-90dc-1cc9da094346"],
Cell[72791, 1838, 422, 5, 62, "Output",ExpressionUUID->"585e4503-8187-4b0d-9f2a-4a30c0e08f68"]
}, Open  ]]
}, Open  ]]
}
]
*)

